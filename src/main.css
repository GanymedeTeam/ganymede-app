@import "tailwindcss";
@import "tw-animate-css";
@import "./assets/fonts/fonts.css";

@plugin "@tailwindcss/typography";
@plugin "../tailwind-slot-plugin.ts";

@keyframes pulse-success {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7);
  }
  50% {
    transform: scale(1.15);
    box-shadow: 0 0 0 8px rgba(16, 185, 129, 0);
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
  }
}

@utility animate-pulse-success {
  animation: pulse-success 0.35s ease-out;
}

@keyframes pulse-accent {
  0% {
    transform: scale(1);
    box-shadow: 0 0 0 0 var(--color-accent-DEFAULT, #e7c272);
  }
  50% {
    transform: scale(1.15);
    box-shadow: 0 0 0 8px transparent;
  }
  100% {
    transform: scale(1);
    box-shadow: 0 0 0 0 transparent;
  }
}

@utility animate-pulse-accent {
  animation: pulse-accent 0.35s ease-out;
}

@theme {
  --color-border: hsl(217.2 32.6% 17.5%);
  --color-background: hsl(236 21% 11%);
  --color-foreground: hsl(210 40% 98%);
  --color-card: hsl(240 27% 10%);
  --color-card-foreground: hsl(210 40% 98%);
  --color-popover: hsl(240 27% 15%);
  --color-popover-foreground: hsl(0 0% 98%);
  --color-primary: hsl(246 15% 42%);
  --color-primary-foreground: hsl(0 0% 90%);
  --color-secondary: hsl(217.2 32.6% 17.5%);
  --color-secondary-foreground: hsl(210 40% 98%);
  --color-muted: hsl(217.2 32.6% 17.5%);
  --color-muted-foreground: hsl(215 20.2% 65.1%);
  --color-accent: var(--color-accent-DEFAULT, #e7c272);
  --color-accent-foreground: var(--color-surface-page, #1d2730);
  --color-destructive: hsl(0 62.8% 30.6%);
  --color-destructive-foreground: hsl(210 40% 98%);
  --color-input: hsl(217.2 32.6% 97.5%);
  --color-ring: var(--color-accent-DEFAULT);
  --color-chart-1: hsl(220 70% 50%);
  --color-chart-2: hsl(160 60% 45%);
  --color-chart-3: hsl(30 80% 55%);
  --color-chart-4: hsl(280 65% 60%);
  --color-chart-5: hsl(340 75% 55%);
}

@theme {
  --color-primary-800: hsl(236 27% 25%);
  --color-primary-900: hsl(236 27% 20%);
  --color-primary-foreground-800: hsl(0 0% 95%);
  --font-liberation: "Liberation", var(--default-font-family);
  --text-xxs: 0.625rem;
  --text-xxs--line-height: calc(0.75 / 0.625);
  --breakpoint-xs: 320px;
  --spacing-titlebar: 30px;
  --spacing-app-without-header: calc(100vh - var(--spacing-titlebar));

  /* Theme: Surfaces */
  --color-surface-page: #1d2730;
  --color-surface-card: #21303c;
  --color-surface-inset: #3e4650;

  /* Theme: Borders */
  --color-border-muted: #3a4a5a;
  --color-border-inset: #121f2a;

  /* Theme: Semantic */
  --color-success: #6abc65;

  /* Theme: Accent (Gold) */
  --color-accent-light: #fceaa8;
  --color-accent-DEFAULT: #e7c272;
  --color-accent-dark: #d7b363;
}

/* Theme: Standard (Violet) */
[data-theme="standard"] {
  --color-surface-page: #1a1a24;
  --color-surface-card: #22222e;
  --color-surface-inset: #2d2d3d;
  --color-border-muted: #3d3d52;
  --color-border-inset: #14141c;
  --color-accent-light: #9a99b8;
  --color-accent-DEFAULT: #77769d;
  --color-accent-dark: #5e5d82;
}

/* Theme: Bonta (Blue) */
[data-theme="bonta"] {
  --color-surface-page: #141c28;
  --color-surface-card: #1a2433;
  --color-surface-inset: #243044;
  --color-border-muted: #3a4d6a;
  --color-border-inset: #0e141c;
  --color-accent-light: #8aadd4;
  --color-accent-DEFAULT: #607fb3;
  --color-accent-dark: #4a6591;
}

/* Theme: Brakmar (Red) */
[data-theme="brakmar"] {
  --color-surface-page: #1e1418;
  --color-surface-card: #281a1f;
  --color-surface-inset: #36242b;
  --color-border-muted: #4d343d;
  --color-border-inset: #160e12;
  --color-accent-light: #c46a78;
  --color-accent-DEFAULT: #a23d4e;
  --color-accent-dark: #82313f;
}

/* Theme: Tribute (Gray) */
[data-theme="tribute"] {
  --color-surface-page: #1a1a1a;
  --color-surface-card: #222222;
  --color-surface-inset: #2e2e2e;
  --color-border-muted: #444444;
  --color-border-inset: #141414;
  --color-accent-light: #9e9e9c;
  --color-accent-DEFAULT: #7c7d7b;
  --color-accent-dark: #606160;
}

/* Theme: Gold and Steel (Bronze) */
[data-theme="gold-steel"] {
  --color-surface-page: #1c1814;
  --color-surface-card: #251f1a;
  --color-surface-inset: #322922;
  --color-border-muted: #4a3e34;
  --color-border-inset: #14120e;
  --color-accent-light: #c9a47d;
  --color-accent-DEFAULT: #aa7c54;
  --color-accent-dark: #886344;
}

/* Theme: Belladone (Mauve) */
[data-theme="belladone"] {
  --color-surface-page: #1a181c;
  --color-surface-card: #231f26;
  --color-surface-inset: #2f2a33;
  --color-border-muted: #453e4a;
  --color-border-inset: #141216;
  --color-accent-light: #ad9dbb;
  --color-accent-DEFAULT: #8d7b9c;
  --color-accent-dark: #71627d;
}

/* Theme: Unicorn (Rose) */
[data-theme="unicorn"] {
  --color-surface-page: #1c161c;
  --color-surface-card: #261d26;
  --color-surface-inset: #342834;
  --color-border-muted: #4c3a4c;
  --color-border-inset: #140f14;
  --color-accent-light: #b68ab6;
  --color-accent-DEFAULT: #976097;
  --color-accent-dark: #794d79;
}

/* Theme: Emerald Mine (Cyan) */
[data-theme="emerald"] {
  --color-surface-page: #14191a;
  --color-surface-card: #1a2223;
  --color-surface-inset: #242e30;
  --color-border-muted: #384648;
  --color-border-inset: #0e1314;
  --color-accent-light: #8cb4b7;
  --color-accent-DEFAULT: #5f8d91;
  --color-accent-dark: #4c7174;
}

/* Theme: Sufokia (Turquoise) */
[data-theme="sufokia"] {
  --color-surface-page: #121a1a;
  --color-surface-card: #182323;
  --color-surface-inset: #222f30;
  --color-border-muted: #364748;
  --color-border-inset: #0c1414;
  --color-accent-light: #7aadae;
  --color-accent-DEFAULT: #498384;
  --color-accent-dark: #3a696a;
}

/* Theme: Pandala (Green) */
[data-theme="pandala"] {
  --color-surface-page: #171a14;
  --color-surface-card: #1e221a;
  --color-surface-inset: #2a2f24;
  --color-border-muted: #404838;
  --color-border-inset: #10120e;
  --color-accent-light: #9db679;
  --color-accent-DEFAULT: #76944f;
  --color-accent-dark: #5e7640;
}

/* Theme: Wabbit (Orange) */
[data-theme="wabbit"] {
  --color-surface-page: #1e1614;
  --color-surface-card: #281d1a;
  --color-surface-inset: #362824;
  --color-border-muted: #4d3a34;
  --color-border-inset: #160f0e;
  --color-accent-light: #d8907a;
  --color-accent-DEFAULT: #c46647;
  --color-accent-dark: #9d5239;
}

/*
  The default border color has changed to `currentColor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    border-color: var(--color-border, currentColor);
  }
}

@utility container {
  margin-inline: auto;
  padding-inline: 2rem;
}

@utility center-absolute {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}

@utility center-y-absolute {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
}

@utility scrollbar-hide {
  scrollbar-width: none;
  -ms-overflow-style: none;

  &::-webkit-scrollbar {
    display: none;
  }
}

@variant has-value (:not(&[value=""]), &:not([value]));
@variant peer-has-value (.peer:not([value=""]) ~ &, .peer:not([value]) ~ &);

@variant first-tab (&:where(.group\/tab:has([data-state="active"]) + .group\/tab:has([data-state="inactive"]) *));
@variant last-tab (&:where(.group\/tab:has([data-state="inactive"]):has(+ .group\/tab > [data-state="active"]) *), &:where(.group\/tab:has([data-state="inactive"]):last-of-type *));

@utility mask-gradient-to-top {
  @apply mask-t-from-0 mask-t-to-12% mask-t-from-transparent mask-t-to-black;
}

@utility mask-gradient-to-left {
  mask: linear-gradient(
    to right,
    transparent,
    rgba(29, 39, 48, 0.5) 20%,
    var(--color-surface-page) 50%,
    var(--color-surface-page) 100%
  );

  /*@apply mask-r-from-0% mask-r-to-90% mask-r-from-surface-page mask-r-to-black;*/
}

@layer base {
  :root {
    --background: 236 21% 11%;
    --font-sans:
      "Lexend", "Inter", system-ui, -apple-system, BlinkMacSystemFont,
      "Segoe UI", "Helvetica Neue", Arial, "Noto Sans", sans-serif,
      "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
      "Noto Color Emoji";
    --default-font-family: var(--font-sans);
    --opacity: 0.93;
  }

  :where(*) {
    -webkit-user-select: none;
    user-select: none;
  }

  body {
    font-feature-settings:
      "rlig" 1,
      "calt" 1;
    overflow: hidden;
    background: color-mix(in srgb, var(--color-surface-page) calc(var(--opacity) * 100%), transparent);
    color: var(--color-foreground);
  }

  :where(*:not(:is(input, textarea, select, a, button, .select-text, code, button *, a *))) {
    -webkit-user-select: none;
    user-select: none;
    cursor: default;
  }

  [data-radix-popper-content-wrapper] {
    z-index: 50 !important;
  }

  html,
  body,
  #root {
    min-height: 100vh;
  }

  #root {
    display: flex;
    flex-direction: column;
  }

  html {
    overscroll-behavior: none;
  }

  body:has(.app-bg) {
    position: relative;

    @variant before {
      content: "";
      display: block;
      inset: 0;
      width: 100%;
      height: 100%;
      position: absolute;
      background: url("@/assets/app-bg.webp") 50% 0 no-repeat;
      background-size: cover;
      opacity: 0.2;
      z-index: -1;
    }
  }

  .scroller {
    scrollbar-gutter: stable;
  }

  .scroller::-webkit-scrollbar-button:vertical:start:increment,
  .scroller::-webkit-scrollbar-button:vertical:end:decrement,
  .scroller::-webkit-scrollbar-button:horizontal:start:increment,
  .scroller::-webkit-scrollbar-button:horizontal:end:decrement {
    display: none;
  }

  .scroller::-webkit-scrollbar {
    width: 15px;
  }

  .scroller::-webkit-scrollbar-thumb {
    border-radius: 10px;
    border: 3px solid transparent;
    border-right-width: 4px;
    background-clip: padding-box;
    background-color: hsl(0, 0%, 80%);
  }

  .scroller::-webkit-scrollbar-thumb:active {
    background-color: hsl(0, 0%, 61%);
  }
  .scroller::-webkit-scrollbar-button {
    width: 15px;
    height: 15px;
    border: 3px solid transparent;
    border-right-width: 4px;
    background-clip: padding-box;
    background-position: center;
    background-repeat: no-repeat;
  }

  .scroller::-webkit-scrollbar-button:vertical:decrement {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 9 9'%3E%3Cpath fill='hsl(0, 0%, 80%)' d='m5.7 1.7 3.1 4.2c.6.9-.1 2.1-1.2 2.1H1.4C.3 8-.4 6.8.2 5.9l3.1-4.2c.5-.9 1.9-.9 2.4 0z' /%3E%3C/svg%3E");
  }
  .scroller::-webkit-scrollbar-button:vertical:increment {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 9 9'%3E%3Cpath fill='hsl(0, 0%, 80%)' d='m5.7 7.3 3.1-4.2C9.4 2.2 8.7 1 7.6 1H1.4C.3 1-.4 2.2.2 3.1l3.1 4.2c.5.9 1.9.9 2.4 0z' /%3E%3C/svg%3E");
  }
  .scroller::-webkit-scrollbar-button:vertical:active:decrement {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 9 9'%3E%3Cpath fill='hsl(0, 0%, 61%)' d='m5.7 1.7 3.1 4.2c.6.9-.1 2.1-1.2 2.1H1.4C.3 8-.4 6.8.2 5.9l3.1-4.2c.5-.9 1.9-.9 2.4 0z' /%3E%3C/svg%3E");
  }
  .scroller::-webkit-scrollbar-button:vertical:active:increment {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 9 9'%3E%3Cpath fill='hsl(0, 0%, 61%)' d='m5.7 7.3 3.1-4.2C9.4 2.2 8.7 1 7.6 1H1.4C.3 1-.4 2.2.2 3.1l3.1 4.2c.5.9 1.9.9 2.4 0z' /%3E%3C/svg%3E");
  }

  .tag-quest,
  .tag-dungeon,
  .tag-monster,
  .tag-item,
  .tag-wakfu-item,
  .guide-step {
    display: inline-flex;
    align-items: baseline;
    border-radius: 20px;
  }

  .tag-quest {
    color: #eb5bc6;
  }

  .tag-dungeon {
    color: #2cc75d;
  }

  .tag-monster {
    color: #d94a4b;
  }

  .tag-item {
    color: #db9542;
  }

  .tag-wakfu-item {
    color: #41b6c4;
  }

  .guide-step {
    text-decoration: underline;
    color: #8e7cc3;
  }

  .tag-monster img,
  .tag-item img,
  .tag-wakfu-item img,
  .tag-dungeon img,
  .tag-quest img,
  .guide-step img {
    align-self: flex-end;
    max-width: 1.5em;
    max-height: 1.5em;
    margin-right: 0.2em;
  }

  .guide-step img[data-icon="true"] {
    margin-right: 0;
  }

  .guide {
    /* List styles */
    ul,
    ol {
      padding: 0 1rem;
      margin: 0.5rem 0.5rem 0.5rem 0.4rem;
    }

    ul li p,
    ol li p {
      margin-top: 0.25em;
      margin-bottom: 0.25em;
    }

    /* Task list specific styles */
    ul[data-type="taskList"] {
      list-style: none;
      margin-left: 0;
      padding: 0;
    }

    ul[data-type="taskList"] li {
      align-items: flex-start;
      display: flex;
    }

    ul[data-type="taskList"] li > label {
      flex: 0 0 auto;
      margin-right: 0.5rem;
      user-select: none;
    }

    ul[data-type="taskList"] li > div {
      flex: 1 1 auto;
    }

    ul[data-type="taskList"] ul[data-type="taskList"] {
      margin: 0;
    }

    .button-bg-color {
      background-color: rgb(31 41 55);
      color: white;
    }

    .img-small {
      width: 20%;
      margin: auto;
    }

    .img-medium {
      width: 50%;
      margin: auto;
    }

    .img-large {
      width: 100%;
      margin: auto;
    }

    .quest-block {
      --opacity-percentage: calc(var(--opacity) * 100%);
      --final-opacity-80: calc(var(--opacity) * 0.8);

      background-color: color-mix(
        in oklab,
        var(--color-surface-inset) clamp(40%, var(--opacity-percentage), 93%),
        transparent
      );

      @variant hover {
        background-color: color-mix(
          in oklab,
          var(--color-surface-inset) clamp(20%, calc(var(--final-opacity-80) * 100%), var(--opacity-percentage)),
          transparent
        );
      }
    }

    input:is([type="button"], [type="submit"], [type="reset"]),
    input[type="file"]::file-selector-button,
    button[data-href] {
      text-align: left;
      word-break: break-all;
    }
  }
}

.toaster[data-sonner-toaster][data-sonner-theme="dark"] {
  --normal-bg: var(--color-surface-inset);
  --normal-text: var(--color-primary-foreground);
  --normal-border: var(--color-surface-page);

  @apply shadow-lg;
}
